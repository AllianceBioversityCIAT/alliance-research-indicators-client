<p-dialog
  [(visible)]="this.setUpProjectService.manageIndicatorModal().show"
  (onHide)="close()"
  [header]="'Create New Indicator'"
  [modal]="true"
  [closable]="true"
  [style]="{ width: '550px', maxHeight: '85vh' }"
  [draggable]="false">
  <div class="indicator-form">
    <div class="grid grid-cols-1 gap-3 mb-4">
      <div>
        <label for="ind-name" class="block text-sm font-medium text-gray-700 mb-2">Name *</label>
        <input id="ind-name" pInputText [(ngModel)]="form().name" placeholder="Indicator name" class="w-full" />
      </div>

      <div>
        <label for="ind-desc" class="block text-sm font-medium text-gray-700 mb-2">Description *</label>
        <textarea
          id="ind-desc"
          pTextarea
          [(ngModel)]="form().description"
          placeholder="Detailed description"
          autoResize="false"
          rows="3"
          class="w-full">
        </textarea>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <div>
          <label for="ind-type" class="block text-xs font-medium text-gray-700 mb-1">Number Type *</label>
          <p-select
            id="ind-type"
            [(ngModel)]="form().numberType"
            [options]="numberTypeOptions"
            optionLabel="label"
            optionValue="value"
            placeholder="Select type"
            class="w-full">
          </p-select>
        </div>

        <div>
          <label for="ind-format" class="block text-xs font-medium text-gray-700 mb-1">Number Format *</label>
          <p-select
            id="ind-format"
            [(ngModel)]="form().numberFormat"
            [options]="numberFormatOptions"
            optionLabel="label"
            optionValue="value"
            placeholder="Select format"
            class="w-full">
          </p-select>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <div>
          <label for="ind-unit" class="block text-xs font-medium text-gray-700 mb-1">Target Unit *</label>
          <input id="ind-unit" pInputText [(ngModel)]="form().targetUnit" placeholder="e.g., kg, units, %" class="w-full" />
        </div>
        <div>
          <label for="ind-years" class="block text-xs font-medium text-gray-700 mb-1">Years *</label>
          <p-multiSelect
            id="ind-years"
            [(ngModel)]="form().years"
            [options]="availableYears"
            optionLabel="label"
            optionValue="value"
            placeholder="Select years"
            [showToggleAll]="true"
            class="w-full">
          </p-multiSelect>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <div>
          <label for="ind-baseline" class="block text-xs font-medium text-gray-700 mb-1">Baseline</label>
          <p-inputNumber
            id="ind-baseline"
            [(ngModel)]="form().baseline"
            [minFractionDigits]="form().numberFormat === 'decimal' ? 1 : 0"
            [maxFractionDigits]="form().numberFormat === 'decimal' ? 6 : 0"
            placeholder="Baseline value"
            class="w-full"></p-inputNumber>
        </div>
        <div>
          <label for="ind-target" class="block text-xs font-medium text-gray-700 mb-1">Target Value</label>
          <p-inputNumber
            id="ind-target"
            [(ngModel)]="form().targetValue"
            [minFractionDigits]="form().numberFormat === 'decimal' ? 1 : 0"
            [maxFractionDigits]="form().numberFormat === 'decimal' ? 6 : 0"
            placeholder="Target value"
            class="w-full"></p-inputNumber>
        </div>
      </div>
    </div>
  </div>

  <div class="flex justify-end gap-2 pt-3 border-t border-gray-200">
    <p-button label="Cancel" severity="secondary" size="small" pTooltip="Cancel indicator creation" (onClick)="close()"> </p-button>
    <p-button label="Create Indicator" size="small" pTooltip="Save and create new indicator" (onClick)="save()"> </p-button>
  </div>
</p-dialog>
