<ng-template #requiredMessage>
  <div class="flex items-center gap-1 mt-1 text-[#E69F00] text-sm">
    <i class="material-symbols-rounded !text-[12px]">warning</i>
    <span class="!text-[14px]">This field is required</span>
  </div>
</ng-template>

<div class="relative flex flex-col gap-4 bg-[#F4F7F9] border border-[#E8EBED] flex-col p-5">
  <div class="flex justify-between gap-1">
    <span class="text-[13px] text-[#8D9299] font-['Space_Grotesk'] tracking-widest">ORGANIZATION # {{ evidenceNumber ?? 1 }}</span>

    @if (submission.isEditableStatus()) {
      <div class="cursor-pointer text-[#CF0808]" (click)="deleteEvidence()" (keydown.enter)="deleteEvidence()">
        <i class="pi pi-times-circle !text-[16px] pr-1"></i>
      </div>
    }
  </div>

  <div class="flex flex-col gap-1">
    <h2 class="text-[16px] font-[600] text-[#153C71] pb-1">Organization type<span class="text-[15px] text-[#CF0808]">*</span></h2>

    <p-select
      [disabled]="!submission.isEditableStatus()"
      [scrollHeight]="'218px'"
      [optionLabel]="'name'"
      [(ngModel)]="body().institution_type_id"
      [style]="organizationMissing ? { width: '100%', border: '2px solid #E69F00' } : { width: '100%' }"
      [optionValue]="'code'"
      (onChange)="onInstitutionTypeChange($event.value)"
      [options]="institutionService.list()">
    </p-select>

    @if (organizationMissing) {
      <ng-container *ngTemplateOutlet="requiredMessage"></ng-container>
    }

    @if (showSubTypeSelect()) {
      <h2 class="text-[16px] mt-3 font-[600] text-[#153C71] pb-1">Subtype<span class="text-[15px] text-[#CF0808]">*</span></h2>

      <p-select
        [disabled]="!submission.isEditableStatus()"
        [scrollHeight]="'218px'"
        [optionLabel]="'name'"
        [(ngModel)]="body().sub_institution_type_id"
        [style]="subTypeMissing ? { width: '100%', border: '2px solid #E69F00' } : { width: '100%' }"
        [optionValue]="'code'"
        [options]="subTypesService.list()">
      </p-select>

      @if (subTypeMissing) {
        <ng-container *ngTemplateOutlet="requiredMessage"></ng-container>
      }
    }

    @if (body().institution_type_id === 78) {
      <app-input
        class="mt-3"
        placeholder="Specify other"
        [signal]="body"
        [isRequired]="true"
        optionValue="institution_type_custom_name"
        [disabled]="!submission.isEditableStatus()"
        type="text"></app-input>
    }
  </div>
</div>
