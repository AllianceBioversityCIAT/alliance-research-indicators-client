<div class="container">
  <h3 class="title-text">CAPSHARING DETAILS</h3>
  <p class="description-text">Description</p>

  <!-- TRAINING TYPE-->

  <div class="card-container">
    <div class="card-title">TRAINING TYPE</div>
    <div class="training-type-columns">
      <div class="column gap-1">
        <app-radio-button label="What training or engagement do you want to report?*" [signal]="body" [serviceName]="'capSharingFormats'" [optionLabel]="'name'" [optionValue]="{ body: 'session_format_id', option: 'session_format_id' }"></app-radio-button>
      </div>

      <div class="column">
        <app-radio-button label="Is this a training or a engagement?*" [signal]="body" [serviceName]="'capSharingTypes'" [optionLabel]="'name'" [optionValue]="{ body: 'session_type_id', option: 'session_type_id' }"></app-radio-button>
      </div>
    </div>
  </div>

  <!-- INDIVIDUAL TRAINING -->

  @if (body().session_format_id === 1) {
    <div class="card-container">
      <div class="card-title">INDIVIDUAL TRAINING</div>
      <div class="field mg-0">
        <app-input label="Trainee name*" [signal]="body" optionValue="aux_trainee_name"></app-input>
      </div>

      <div class="individual-training-columns">
        <div class="column gap-1">
          <app-radio-button label="Degree*" [signal]="body" [serviceName]="'capSharingDegrees'" [optionLabel]="'name'" [optionValue]="{ body: 'individual.degree_id', option: 'degree_id' }"></app-radio-button>
        </div>

        <div class="column">
          <app-radio-button label="Gender*" [signal]="body" [serviceName]="'capSharingGenders'" [optionLabel]="'name'" [optionValue]="{ body: 'individual.gender_id', option: 'gender_id' }"></app-radio-button>
        </div>

        <div class="column">
          <app-radio-button label="Lenght of training*" [signal]="body" [serviceName]="'capSharingLengths'" [optionLabel]="'name'" [optionValue]="{ body: 'individual.session_length_id', option: 'session_length_id' }"></app-radio-button>
        </div>
      </div>

      <div class="trainee-columns">
        <div class="column">
          <app-select label="Trainee affiliation" [signal]="body" [optionLabel]="'name'" [optionValue]="{ body: 'aux_institution_id', option: 'institution_id' }" [serviceName]="'institutions'"></app-select>
        </div>

        <div class="column">
          <app-select label="Trainee nationality" [signal]="body" [optionLabel]="'name'" [optionValue]="{ body: 'aux_isoAlpha2', option: 'isoAlpha2' }" [serviceName]="'countries'"></app-select>
        </div>
      </div>
    </div>
  }

  <!-- GROUP TRAINING -->

  @if (body().session_format_id === 2) {
    <div class="card-container">
      <div class="card-title">GROUP TRAINING</div>

      <div class="columns">
        <div class="column">
          <app-input label="What was the total number of participants?" type="number" [signal]="body" [optionValue]="'aux_session_participants_total'"></app-input>
        </div>

        <div class="column">
          <app-input label="Male participants?" [signal]="body" optionValue="aux_session_participants_male" type="number"></app-input>
        </div>
      </div>

      <div class="columns">
        <div class="column">
          <app-input label="Female participants?" [signal]="body" optionValue="aux_session_participants_female" type="number"></app-input>
        </div>

        <div class="column">
          <app-input label="Non-binary participants?" [signal]="body" optionValue="aux_session_participants_non_binary" type="number"></app-input>
        </div>
      </div>

      <div class="columns">
        <div class="column">
          <app-radio-button label="What was the purpose of this training/engagement?*" [signal]="body" [serviceName]="'capSharingSessionPurpose'" [optionLabel]="'name'" [optionValue]="{ body: 'group.session_purpose_id', option: 'session_purpose_id' }"></app-radio-button>
        </div>

        <div class="column">
          <app-radio-button label="Were the trainees attending on behalf of an organization?*" [signal]="body" [optionLabel]="'name'" [serviceName]="'yesOrNo'" [optionValue]="{ body: 'group.is_attending_organization', option: 'value' }"></app-radio-button>
        </div>
      </div>

      <!-- Other -->

      @if (body().group?.session_purpose_id === 4) {
        <div class="columns">
          <div class="column">
            <app-input [signal]="body" optionValue="aux_session_purpose_description"></app-input>
          </div>
        </div>
      }

      <div class="column">
        <app-multiselect label="Select the organizations*" description="Partner organizations you collaborated with or are currently collaborating with to generate this result." [signal]="body" optionLabel="name" optionValue="institution_id" signalOptionValue="aux_trainee_organization_representative" serviceName="institutions">
          @if (!this.loading()) {
            <ng-template #rows let-institution>
              <div class="item-content">
                <div class="information">
                  <div class="row">
                    <div>
                      <strong>{{ institution.acronym }}</strong> - {{ institution.name }}
                    </div>
                    <div class="institution-type">
                      <h4>Institution Type</h4>
                      &nbsp; <span class="material-symbols-rounded"> arrow_forward </span>&nbsp;
                      <span class="institution-type-description">{{ institution?.institution_type?.name }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          }
        </app-multiselect>
      </div>
    </div>
  }

  <!-- TRAINING DETAILS -->

  <div class="card-container">
    <div class="card-title">TRAINING DETAILS</div>

    <div class="trainee-details-columns">
      <div class="column">
        <app-select label="Training / Engagement supervisor*" [signal]="body" [optionValue]="{ body: 'aux_user_id', option: 'user_id' }" optionLabel="full_name" serviceName="userStaff"> </app-select>
      </div>

      <div class="column">
        <app-select label="Language" [signal]="body" [optionLabel]="'name'" [optionValue]="{ body: 'aux_language_id', option: 'id' }" [serviceName]="'languages'"> </app-select>
      </div>
    </div>

    <div class="trainee-details-columns">
      <div class="column">
        <!-- <app-input label="Start date" [signal]="body" [optionValue]="'test'"></app-input>
          -->
        <app-calendar-input label="Start date" [signal]="body" [optionValue]="'start_date'"></app-calendar-input>
      </div>

      <div class="column">
        <app-calendar-input label="End date" [signal]="body" [optionValue]="'end_date'"></app-calendar-input>
      </div>
    </div>

    <div class="modality-container">
      <app-radio-button label="Delivery modality*" [signal]="body" [serviceName]="'capSharingDeliveryModalities'" [optionLabel]="'name'" [optionValue]="{ body: 'delivery_modality_id', option: 'delivery_modality_id' }"></app-radio-button>
    </div>
  </div>

  <div class="button-container">
    <p-button label="Back" icon="pi pi-arrow-left" iconPos="left" (click)="saveData('back')"></p-button>
    <p-button label="Next" icon="pi pi-arrow-right" iconPos="left" (click)="saveData('next')"></p-button>
    <p-button label="Save" icon="pi pi-save" iconPos="left" (click)="saveData()"></p-button>
  </div>
</div>
