<div class="app-page-wrapper">
  <app-form-header />
  <div class="flex flex-col bg-[#fcfcfc] rounded-[10px] p-[30px] mb-6">
    <div class="font-['Space_Grotesk'] text-[14px] font-medium text-[#8d9299] uppercase mb-[30px] mt-0">CONTRIBUTIONS TO INDICATORS</div>

    <div class="text-[12px] text-[#8D9299] mb-6">
      This section needs to be completed because this result is mapped to one or more projects with configured indicators.
    </div>

    <p-tabs [value]="currentProject()?.agreement_id ?? ''" scrollable class="mb-6">
      <p-tablist>
        @for (tab of projects(); track tab.agreement_id) {
          <p-tab
            pInputText
            [pTooltip]="tab.description"
            tooltipPosition="right"
            [value]="tab.agreement_id"
            (click)="onProjectChange(tab)"
            (keydown.enter)="onProjectChange(tab)"
            class="mx-1">
            {{ tab.agreement_id }}
          </p-tab>
        }
      </p-tablist>
    </p-tabs>

    <div class="flex flex-col gap-4 mb-4">
      <label for="indicators-multiselect" class="block text-sm font-medium text-gray-700">Select indicators</label>
      <!-- <p-multiSelect
        id="indicators-multiselect"
        placeholder="Select indicators"
        [options]="currentIndicators()"
        [(ngModel)]="selectedProjects"
        optionLabel="name"
        optionValue="id"
        [filter]="true"
        [filterBy]="'name'"
        class="w-full" /> -->

      <app-multiselect
        label="Contributing projects"
        [signal]="body"
        textSpan="Select the required primary project for this result. Note that only one project can be selected."
        optionLabel="name"
        optionValue="id"
        signalOptionValue="selectedIndicators"
        [isRequired]="false"
        [scrollHeight]="'290px'"
        [filterBy]="'select_label,project_lead_description'"
        [itemHeight]="70"
        serviceName="getProjectIndicatorsHierarchy">
        <ng-template #item let-item>
          <div>{{ item.name }}</div>
        </ng-template>

        <ng-template #selectedItems let-value>
          <h1>Selected</h1>
        </ng-template>
        <ng-template #rows let-indicator>
          <div class="w-full">
            <app-input
              [label]="indicator.targetUnit"
              [isRequired]="false"
              [validateEmpty]="true"
              [signal]="this.body"
              optionValue="title"
              [placeholder]="'Enter the value for: ' + indicator.targetUnit"></app-input>
          </div>
        </ng-template>
      </app-multiselect>
    </div>
  </div>

  <app-navigation-buttons (back)="saveData('back')" (next)="saveData('next')" (save)="saveData()" />
</div>
